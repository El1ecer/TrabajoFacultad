{% extends "plantilla.html" %}
{% load static %}
{% block contenido %}
<h1>LISTADO DE DOCENTES</h1> <br>

<a href="/Teaching/nuevoDocente/" class="btn btn-primary">AGREGAR NUEVO DOCENTE</a>

<br><br>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<table class="table table-bordered table-striped table-hover" id="tblDocentes">
  <thead>
    <tr>
      <th>ID</th>
      <th>NOMBRE</th>
      <th>APELLIDO</th>
      <th>EDAD</th>
      <th>EMAIL</th>
      <th>CARRERA</th>
      <th>LOGO</th>
      <th>PDF</th>
      <th>ACCIONES</th>
    </tr>
  </thead>
  <tbody>
    {% for docenteTemp in docentes %}
      <tr>
        <td>{{ docenteTemp.id }}</td>
        <td>{{ docenteTemp.first_name }}</td>
        <td>{{ docenteTemp.last_name }}</td>
        <td>{{ docenteTemp.age|default:"-" }}</td>
        <td>{{ docenteTemp.email|default:"-" }}</td>
        <td>{% if docenteTemp.carrera %}{{ docenteTemp.carrera.name_career }}{% else %}-{% endif %}</td>
        <td>
          {% if docenteTemp.logo %}
            <img src="{{ docenteTemp.logo.url }}" height="80" alt="Logo {{ docenteTemp.first_name }}">
          {% else %}
            Ninguno
          {% endif %}
        </td>
        <td>
          {% if docenteTemp.pdf %}
            <a href="{{ docenteTemp.pdf.url }}" target="_blank">Ver PDF</a>
          {% else %}
            Ninguno
          {% endif %}
        </td>
        <td>
            {% if docenteTemp.id %}
                <a href="/Teaching/editarDocente/{{ docenteTemp.id }}/" class="btn btn-outline-warning">
                    <i class="fa fa-pen"></i>
                </a>
                {% else %}
                <button class="btn btn-outline-warning" disabled>
                    <i class="fa fa-pen"></i>
                </button>
            {% endif %}

          <a href="#" onclick="confirmarEliminacion({{ docenteTemp.id }})" class="btn btn-outline-danger">
            <i class="fa fa-trash"></i>
          </a>
        </td>
      </tr>
    {% endfor %}
  </tbody>
</table>

<script>
  $('#tblDocentes').DataTable({
    dom: 'Bfrtip',
    buttons: ['copy', 'csv', 'excel', 'pdf', 'print'],
    language: { url: 'https://cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json' }
  });

  function confirmarEliminacion(id) {
    Swal.fire({
        title: "¿Estás seguro?",
        text: "Esta acción no se puede deshacer",
        icon: "warning",
        showCancelButton: true,
        confirmButtonColor: "#3085d6",
        cancelButtonColor: "#d33",
        confirmButtonText: "Sí, eliminar"
    }).then((result) => {
        if (result.isConfirmed) {
            let url = "/Teaching/eliminarDocente/" + id + "/";
            window.location.href = url;
        }
    });
  }
</script>

{% if messages %}
  {% for mensaje in messages %}
    <script>
      Swal.fire({
        title: "CONFIRMACIÓN",
        text: "{{ mensaje|escapejs }}",
        icon: "success"
      });
    </script>
  {% endfor %}
{% endif %}

<br><br><br><br><br><br><br><br><br>
{% endblock %}
